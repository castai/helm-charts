# Default values for the CAST AI Autoscaler profile.
# Toggle individual components on/off as needed.
#
# Provider-specific notes:
#   - global.castai.provider must be set to: eks | aks | gke
#   - spot-handler.castai.provider is derived automatically by the spot-handler chart
#     from global.castai.provider (eks->aws, aks->azure, gke->gcp)
#   - cluster-controller.aks.enabled must be set to true on AKS clusters

# ---------------------------------------------------------------------------
# Core — always on
# ---------------------------------------------------------------------------

agent:
  enabled: true
  replicaCount: 1
  apiKeySecretRef: castai-credentials
  createNamespace: false

spot-handler:
  enabled: true
  castai:
    # provider is resolved by the spot-handler chart from global.castai.provider.
    # Override here only if you need to decouple from the global value.
    provider: ""
    clusterIdConfigMapKeyRef:
      name: castai-agent-metadata
      key: CLUSTER_ID
  apiKeySecretRef: castai-credentials

cluster-controller:
  enabled: true
  castai:
    apiKeySecretRef: castai-credentials
  envFrom:
    - configMapRef:
        name: castai-agent-metadata
  autoscaling:
    enabled: true
  aks:
    enabled: false

# ---------------------------------------------------------------------------
# WOOP stack — on by default
# ---------------------------------------------------------------------------

workload-autoscaler:
  enabled: true
  fullnameOverride: castai-workload-autoscaler
  castai:
    apiKeySecretRef: castai-credentials
    configMapRef: castai-agent-metadata

workload-autoscaler-exporter:
  enabled: true
  fullnameOverride: castai-workload-autoscaler-exporter
  castai:
    apiKeySecretRef: castai-credentials
    configMapRef: castai-agent-metadata

evictor:
  enabled: true
  replicaCount: 1
  aggressiveMode: false
  overrideEnvFrom: true
  envFrom:
    - secretRef:
        name: castai-credentials
    - configMapRef:
        name: castai-agent-metadata

# ---------------------------------------------------------------------------
# Optional add-ons — opt-in
# ---------------------------------------------------------------------------

pod-mutator:
  enabled: false
  fullnameOverride: castai-pod-mutator
  dependencyCheck:
    enabled: false
  castai:
    apiKeySecretRef: castai-credentials
    configMapRef: castai-agent-metadata
  envFrom:
    - configMapRef:
        name: castai-agent-metadata

pod-pinner:
  enabled: false
  castai:
    apiKeySecretRef: castai-credentials
    clusterIdConfigMapKeyRef:
      name: castai-agent-metadata
      key: CLUSTER_ID
  replicaCount: 0

ai-optimizer-proxy:
  enabled: false
  castai:
    apiKeySecretRef: castai-credentials
    clusterIdConfigMapKeyRef:
      name: castai-agent-metadata
      key: CLUSTER_ID

# ---------------------------------------------------------------------------
# Disabled by default 
# ---------------------------------------------------------------------------

metrics-server:
  enabled: false

# ---------------------------------------------------------------------------
# Disabled by default in autoscaler profile
# (available for opt-in; full values documented in the live subchart)
# ---------------------------------------------------------------------------

live:
  enabled: false
  castai:
    apiKeySecretRef: castai-credentials
    configMapRef: castai-agent-metadata
  castai-aws-vpc-cni:
    enabled: false
  daemon:
    labelNodeSubnet: true
  controller:
    replicaCount: 0
